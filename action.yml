name: ROS 2 Build and Test Workspace
description: Build and test a ROS 2 workspace from source
author: ICHIRO ITS
branding:
  icon: activity
  color: gray-dark
inputs:
  ros2-distro:
    description: The ROS 2 distribution to be used.
    required: false
    default: iron
runs:
  using: composite
  steps:
    - uses: ichiro-its/ros2-build-and-test-action/setup@dfe0ad86dc3adcc73f9314c8ab4d585263caa7f0
      with:
        ros2-distro: ${{ inputs.ros2-distro }}

    - uses: ichiro-its/ros2-build-and-test-action/build@83681337c83fd88d63d1826964a55edbaf56ea2f
      with:
        ros2-distro: ${{ inputs.ros2-distro }}

    - shell: bash
      run: |
        source install/setup.bash
        colcon test --event-handlers console_cohesion+ --pytest-with-coverage --return-code-on-test-failure
